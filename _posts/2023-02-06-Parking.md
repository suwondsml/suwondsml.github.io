---
layout: post
title: Parking
authors: [Seoyeon Bae]
categories: [1기 AI/SW developers(개인 프로젝트)]
---


# 주차수요 예측

유형별 임대주택 설계 시 단지 내 적정 주차 수요를 예측

## 패키지 불러오기


```python
import pandas as pd
import numpy as np

# 한글폰트 설정, 그래프 마이너스 표시 설정
import matplotlib
from matplotlib import font_manager, rc
from matplotlib import pyplot as plt
import platform
import seaborn as sns

if platform.system() == 'Windows':
# 윈도우인 경우
    font_name = font_manager.FontProperties(fname="c:/Windows/Fonts/malgun.ttf").get_name()
    rc('font', family=font_name)
else:    
# Mac 인 경우
    rc('font', family='AppleGothic')

matplotlib.rcParams['axes.unicode_minus'] = False
```

## 데이터 확인해보기

### 데이터 불러오기


```python
train = pd.read_csv('train.csv')
test = pd.read_csv('test.csv')
age_gender_info = pd.read_csv('age_gender_info.csv')
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
      <th>등록차량수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>39.72</td>
      <td>134</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000</td>
      <td>103680</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>39.72</td>
      <td>15</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000</td>
      <td>103680</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>385</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000</td>
      <td>184330</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>15</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000</td>
      <td>184330</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>41</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000</td>
      <td>184330</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1072</td>
      <td>754</td>
      <td>아파트</td>
      <td>경기도</td>
      <td>국민임대</td>
      <td>39.79</td>
      <td>116</td>
      <td>14.0</td>
      <td>H</td>
      <td>22830000</td>
      <td>189840</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1072</td>
      <td>754</td>
      <td>아파트</td>
      <td>경기도</td>
      <td>국민임대</td>
      <td>46.81</td>
      <td>30</td>
      <td>14.0</td>
      <td>A</td>
      <td>36048000</td>
      <td>249930</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1072</td>
      <td>754</td>
      <td>아파트</td>
      <td>경기도</td>
      <td>국민임대</td>
      <td>46.90</td>
      <td>112</td>
      <td>14.0</td>
      <td>H</td>
      <td>36048000</td>
      <td>249930</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C1072</td>
      <td>754</td>
      <td>아파트</td>
      <td>경기도</td>
      <td>국민임대</td>
      <td>46.90</td>
      <td>120</td>
      <td>14.0</td>
      <td>H</td>
      <td>36048000</td>
      <td>249930</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C1072</td>
      <td>754</td>
      <td>아파트</td>
      <td>경기도</td>
      <td>국민임대</td>
      <td>51.46</td>
      <td>60</td>
      <td>14.0</td>
      <td>H</td>
      <td>43497000</td>
      <td>296780</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.loc[train.임대보증금=='-', '임대보증금'] = np.nan
test.loc[test.임대보증금=='-', '임대보증금'] = np.nan
train['임대보증금'] = train['임대보증금'].astype(float)
test['임대보증금'] = test['임대보증금'].astype(float)

train.loc[train.임대료=='-', '임대료'] = np.nan
test.loc[test.임대료=='-', '임대료'] = np.nan
train['임대료'] = train['임대료'].astype(float)
test['임대료'] = test['임대료'].astype(float)
```

#### train (학습용) 데이터

- 단지코드
- 총세대수
- 임대건물구분
- 지역
- 공급유형
- 전용면적
- 전용면적별세대수
- 공가수
- 신분
- 임대료보증금
- 임대료
- 도보 10분거리 내 지하철역 수(환승노선 수 반영)
- 도보 10분거리 내 버스정류장 수
- 단지내주차면수
- 등록차량수

#### test (테스트) 데이터

- 단지코드
- 총세대수
- 임대건물구분
- 지역
- 공급유형
- 전용면적
- 전용면적별세대수
- 공가수
- 신분
- 임대료보증금
- 임대료
- 도보 10분거리 내 지하철역 수(환승노선 수 반영)
- 도보 10분거리 내 버스정류장 수
- 단지내주차면수

#### age_gender_info (지역 임대주택 나이별, 성별 인구 분포)

- 지역
- 10대미만(여자)
- 10대미만(남자)
- 20대(여자)
- 20대(남자)
- 30대(여자)
- 30대(남자)
- 40대(여자)
- 40대(남자)
- 50대(여자)
- 50대(남자)
- 60대(여자)
- 60대(남자)
- 70대(여자)
- 70대(남자)
- 80대(여자)
- 80대(남자)
- 90대(여자)
- 90대(남자)
- 100대(여자)
- 100대(남자)

#### sample_submission (제출)

- code : 단지 코드
- num : 등록차량수

## 결측값 확인하기

#### 임대보증금, 임대료


```python
train[train.임대보증금.isnull()].공급유형.value_counts()
```




    임대상가    562
    국민임대      8
    공공분양      7
    행복주택      4
    Name: 공급유형, dtype: int64




```python
test[test.임대보증금.isnull()].공급유형.value_counts()
```




    임대상가    177
    영구임대      5
    행복주택      4
    Name: 공급유형, dtype: int64




```python
train[train.임대보증금.isnull()].자격유형.value_counts()
```




    D    569
    H      8
    K      4
    Name: 자격유형, dtype: int64




```python
test[test.임대보증금.isnull()].자격유형.value_counts()
```




    D    180
    L      4
    C      2
    Name: 자격유형, dtype: int64




```python
train[train.자격유형.isin(['D', 'H', 'K'])].info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 757 entries, 88 to 2919
    Data columns (total 15 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   단지코드                          757 non-null    object 
     1   총세대수                          757 non-null    int64  
     2   임대건물구분                        757 non-null    object 
     3   지역                            757 non-null    object 
     4   공급유형                          757 non-null    object 
     5   전용면적                          757 non-null    float64
     6   전용면적별세대수                      757 non-null    int64  
     7   공가수                           757 non-null    float64
     8   자격유형                          757 non-null    object 
     9   임대보증금                         176 non-null    float64
     10  임대료                           176 non-null    float64
     11  도보 10분거리 내 지하철역 수(환승노선 수 반영)  623 non-null    float64
     12  도보 10분거리 내 버스정류장 수            757 non-null    float64
     13  단지내주차면수                       757 non-null    float64
     14  등록차량수                         757 non-null    float64
    dtypes: float64(8), int64(2), object(5)
    memory usage: 94.6+ KB
    


```python
test[test.자격유형.isin(['D', 'L', 'C'])].info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 226 entries, 73 to 1017
    Data columns (total 14 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   단지코드                          226 non-null    object 
     1   총세대수                          226 non-null    int64  
     2   임대건물구분                        226 non-null    object 
     3   지역                            226 non-null    object 
     4   공급유형                          226 non-null    object 
     5   전용면적                          226 non-null    float64
     6   전용면적별세대수                      226 non-null    int64  
     7   공가수                           226 non-null    float64
     8   자격유형                          226 non-null    object 
     9   임대보증금                         40 non-null     float64
     10  임대료                           40 non-null     float64
     11  도보 10분거리 내 지하철역 수(환승노선 수 반영)  201 non-null    float64
     12  도보 10분거리 내 버스정류장 수            226 non-null    float64
     13  단지내주차면수                       226 non-null    float64
    dtypes: float64(7), int64(2), object(5)
    memory usage: 26.5+ KB
    


```python
# 임대보증금과 임대료가 NULL인 경우는 0으로 대체하는 것이 좋아보임
train[['임대보증금', '임대료']] = train[['임대보증금', '임대료']].fillna(0)
test[['임대보증금', '임대료']] = test[['임대보증금', '임대료']].fillna(0)
```

#### 도보 10분거리 내 지하철역 수 (환승노선  수 반영), 버스정류장 수

#### NULL 값을 0으로 대체하기


```python
subway_null_codes = train[train['도보 10분거리 내 지하철역 수(환승노선 수 반영)'].isnull()].단지코드.unique()
train.loc[train.단지코드.isin(subway_null_codes), '도보 10분거리 내 지하철역 수(환승노선 수 반영)'].value_counts(dropna=False)
```




    NaN    211
    Name: 도보 10분거리 내 지하철역 수(환승노선 수 반영), dtype: int64




```python
subway_null_codes = test[test['도보 10분거리 내 지하철역 수(환승노선 수 반영)'].isnull()].단지코드.unique()
test.loc[test.단지코드.isin(subway_null_codes), '도보 10분거리 내 지하철역 수(환승노선 수 반영)'].value_counts(dropna=False)
```




    NaN    42
    Name: 도보 10분거리 내 지하철역 수(환승노선 수 반영), dtype: int64




```python
bus_null_codes = train[train['도보 10분거리 내 버스정류장 수'].isnull()].단지코드.unique()
train.loc[train.단지코드.isin(bus_null_codes), '도보 10분거리 내 버스정류장 수'].value_counts(dropna=False)
```




    NaN    4
    Name: 도보 10분거리 내 버스정류장 수, dtype: int64




```python
cols = ['도보 10분거리 내 지하철역 수(환승노선 수 반영)', '도보 10분거리 내 버스정류장 수']
train[cols] = train[cols].fillna(0)
test[cols] = test[cols].fillna(0)
```

#### 자격유형


```python
test[test.자격유형.isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>196</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>46.90</td>
      <td>240</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>71950000.0</td>
      <td>37470.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>258</th>
      <td>C2253</td>
      <td>1161</td>
      <td>아파트</td>
      <td>강원도</td>
      <td>영구임대</td>
      <td>26.37</td>
      <td>745</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2249000.0</td>
      <td>44770.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test[test.단지코드=='C2411'] # A로 채우면 될듯
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>193</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>39.43</td>
      <td>56</td>
      <td>25.0</td>
      <td>A</td>
      <td>11992000.0</td>
      <td>100720.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>39.72</td>
      <td>336</td>
      <td>25.0</td>
      <td>A</td>
      <td>11992000.0</td>
      <td>100720.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>195</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>39.82</td>
      <td>179</td>
      <td>25.0</td>
      <td>A</td>
      <td>11992000.0</td>
      <td>100720.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>46.90</td>
      <td>240</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>71950000.0</td>
      <td>37470.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>197</th>
      <td>C2411</td>
      <td>962</td>
      <td>아파트</td>
      <td>경상남도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>150</td>
      <td>25.0</td>
      <td>A</td>
      <td>21586000.0</td>
      <td>171480.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.loc[test.단지코드.isin(['C2411']) & test.자격유형.isnull(), '자격유형'] = 'A'
```


```python
test[test.단지코드=='C2253'].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>258</th>
      <td>C2253</td>
      <td>1161</td>
      <td>아파트</td>
      <td>강원도</td>
      <td>영구임대</td>
      <td>26.37</td>
      <td>745</td>
      <td>0.0</td>
      <td>C</td>
      <td>2249000.0</td>
      <td>44770.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>259</th>
      <td>C2253</td>
      <td>1161</td>
      <td>아파트</td>
      <td>강원도</td>
      <td>영구임대</td>
      <td>31.32</td>
      <td>239</td>
      <td>0.0</td>
      <td>C</td>
      <td>3731000.0</td>
      <td>83020.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>260</th>
      <td>C2253</td>
      <td>1161</td>
      <td>아파트</td>
      <td>강원도</td>
      <td>영구임대</td>
      <td>31.32</td>
      <td>149</td>
      <td>0.0</td>
      <td>C</td>
      <td>3731000.0</td>
      <td>83020.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>261</th>
      <td>C2253</td>
      <td>1161</td>
      <td>상가</td>
      <td>강원도</td>
      <td>임대상가</td>
      <td>13.77</td>
      <td>1</td>
      <td>0.0</td>
      <td>D</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>262</th>
      <td>C2253</td>
      <td>1161</td>
      <td>상가</td>
      <td>강원도</td>
      <td>임대상가</td>
      <td>22.89</td>
      <td>1</td>
      <td>0.0</td>
      <td>D</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.loc[test.단지코드.isin(['C2253']) & test.자격유형.isnull(), '자격유형'] = 'C'
```

### 중복되는 데이터가 있는지 확인해보기


```python
train.shape, train.drop_duplicates().shape
```




    ((2952, 15), (2632, 15))




```python
test.shape, test.drop_duplicates().shape
```




    ((1022, 14), (949, 14))



중복되는 데이터는 drop 한 후 분석


```python
train = train.drop_duplicates()
test = test.drop_duplicates()
```


```python
train[train.단지코드=='C2483']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>단지코드</th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
      <th>등록차량수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>39.72</td>
      <td>134</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000.0</td>
      <td>103680.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>39.72</td>
      <td>15</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000.0</td>
      <td>103680.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>385</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000.0</td>
      <td>184330.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>15</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000.0</td>
      <td>184330.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.93</td>
      <td>41</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000.0</td>
      <td>184330.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.95</td>
      <td>89</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000.0</td>
      <td>184330.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>51.95</td>
      <td>135</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000.0</td>
      <td>184330.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>C2483</td>
      <td>900</td>
      <td>아파트</td>
      <td>경상북도</td>
      <td>국민임대</td>
      <td>59.88</td>
      <td>86</td>
      <td>38.0</td>
      <td>A</td>
      <td>30357000.0</td>
      <td>214270.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(f"단지코드 C2483에서 유일한 값을 가지는 변수들:\n{list(train.columns[train[train.단지코드=='C2483'].nunique()==1])}")
```

    단지코드 C2483에서 유일한 값을 가지는 변수들:
    ['단지코드', '총세대수', '임대건물구분', '지역', '공급유형', '공가수', '자격유형', '도보 10분거리 내 지하철역 수(환승노선 수 반영)', '도보 10분거리 내 버스정류장 수', '단지내주차면수', '등록차량수']
    


```python
train.groupby(['단지코드']).nunique(dropna=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총세대수</th>
      <th>임대건물구분</th>
      <th>지역</th>
      <th>공급유형</th>
      <th>전용면적</th>
      <th>전용면적별세대수</th>
      <th>공가수</th>
      <th>자격유형</th>
      <th>임대보증금</th>
      <th>임대료</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
      <th>등록차량수</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>15</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2663</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C2666</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C2670</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C2680</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C2692</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 14 columns</p>
</div>




```python
train.groupby(['단지코드']).nunique(dropna=False).sum(axis=0)
```




    총세대수                             423
    임대건물구분                           456
    지역                               423
    공급유형                             488
    전용면적                            1898
    전용면적별세대수                        2230
    공가수                              423
    자격유형                             510
    임대보증금                           1277
    임대료                             1289
    도보 10분거리 내 지하철역 수(환승노선 수 반영)     423
    도보 10분거리 내 버스정류장 수               423
    단지내주차면수                          423
    등록차량수                            423
    dtype: int64



423보다 큰 값이 있는 것들은 하나의 단지코드에 둘 이상의 항목이 있다는 것임.

임대건물구분, 공급유형, 전용면적, 전용면적별세대수, 자격유형, 임대보증금, 임대료는 하나의 단지코드에 둘 이상의 항목이 존재함.

## 단지코드 별 집계

#### 하나의 단지코드에 하나의 값만 존재하는 변수들

총세대수, 지역, 공가수, 도보 10분거리 내 지하철역 수(환승노선 수 반영), 도보 10분거리 내 버스정류장 수, 단지내주차면수, 등록차량수


```python
unique_cols = ['총세대수', '지역', '공가수', 
               '도보 10분거리 내 지하철역 수(환승노선 수 반영)',
               '도보 10분거리 내 버스정류장 수',
               '단지내주차면수', '등록차량수']
train_agg = train.set_index('단지코드')[unique_cols].drop_duplicates()
test_agg = test.set_index('단지코드')[[col for col in unique_cols if col!='등록차량수']].drop_duplicates()
```


```python
train_agg
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총세대수</th>
      <th>지역</th>
      <th>공가수</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
      <th>등록차량수</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C2483</th>
      <td>900</td>
      <td>경상북도</td>
      <td>38.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>C2515</th>
      <td>545</td>
      <td>경상남도</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>624.0</td>
      <td>205.0</td>
    </tr>
    <tr>
      <th>C1407</th>
      <td>1216</td>
      <td>대전광역시</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1285.0</td>
      <td>1064.0</td>
    </tr>
    <tr>
      <th>C1945</th>
      <td>755</td>
      <td>경기도</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>734.0</td>
      <td>730.0</td>
    </tr>
    <tr>
      <th>C1470</th>
      <td>696</td>
      <td>전라북도</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>645.0</td>
      <td>553.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2586</th>
      <td>90</td>
      <td>제주특별자치도</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>66.0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>C2035</th>
      <td>492</td>
      <td>강원도</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>521.0</td>
      <td>246.0</td>
    </tr>
    <tr>
      <th>C2020</th>
      <td>40</td>
      <td>부산광역시</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>25.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>C2437</th>
      <td>90</td>
      <td>충청북도</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>30.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>C2532</th>
      <td>239</td>
      <td>강원도</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>166.0</td>
      <td>146.0</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 7 columns</p>
</div>




```python
test_agg
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총세대수</th>
      <th>지역</th>
      <th>공가수</th>
      <th>도보 10분거리 내 지하철역 수(환승노선 수 반영)</th>
      <th>도보 10분거리 내 버스정류장 수</th>
      <th>단지내주차면수</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1072</th>
      <td>754</td>
      <td>경기도</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>C1128</th>
      <td>1354</td>
      <td>경기도</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1216.0</td>
    </tr>
    <tr>
      <th>C1456</th>
      <td>619</td>
      <td>부산광역시</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>547.0</td>
    </tr>
    <tr>
      <th>C1840</th>
      <td>593</td>
      <td>전라북도</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>543.0</td>
    </tr>
    <tr>
      <th>C1332</th>
      <td>1297</td>
      <td>경기도</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1112.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2456</th>
      <td>349</td>
      <td>제주특별자치도</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>270.0</td>
    </tr>
    <tr>
      <th>C1266</th>
      <td>596</td>
      <td>충청북도</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>593.0</td>
    </tr>
    <tr>
      <th>C2152</th>
      <td>120</td>
      <td>강원도</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>C1267</th>
      <td>675</td>
      <td>경상남도</td>
      <td>38.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>467.0</td>
    </tr>
    <tr>
      <th>C2189</th>
      <td>382</td>
      <td>전라북도</td>
      <td>45.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>300.0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 6 columns</p>
</div>



#### 하나의 단지코드에 둘 이상의 값이 존재하는 변수들

임대건물구분, 공급유형, 전용면적, 전용면적별세대수, 자격유형, 임대보증금, 임대료


```python
def reshape_cat_features(data, cast_col, value_col):
    res = data.drop_duplicates(['단지코드', cast_col]).assign(counter=1).pivot(index='단지코드', columns=cast_col, values=value_col).fillna(0)
    res.columns.name = None
    res = res.rename(columns={col:cast_col+'_'+col for col in res.columns})
    return res
```

#### 임대건물구분: 아파트/상가 

임대건물구분을 열로 바꾼 후, 
단지가 주상복합인지 아닌지 확인할 수 있게 함.


```python
reshape_cat_features(data=train, cast_col='임대건물구분', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>임대건물구분_상가</th>
      <th>임대건물구분_아파트</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2663</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2666</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2670</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2680</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2692</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 2 columns</p>
</div>




```python
reshape_cat_features(data=test, cast_col='임대건물구분', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>임대건물구분_상가</th>
      <th>임대건물구분_아파트</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1003</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1006</th>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1016</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1019</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1030</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2653</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2675</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2676</th>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2688</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C2691</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 2 columns</p>
</div>




```python
pd.concat([train.공급유형.value_counts(), test.공급유형.value_counts()], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>공급유형</th>
      <th>공급유형</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>국민임대</th>
      <td>1730</td>
      <td>619.0</td>
    </tr>
    <tr>
      <th>임대상가</th>
      <td>285</td>
      <td>112.0</td>
    </tr>
    <tr>
      <th>공공임대(10년)</th>
      <td>203</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>행복주택</th>
      <td>203</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>영구임대</th>
      <td>149</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>공공임대(50년)</th>
      <td>31</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>공공임대(분납)</th>
      <td>12</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>장기전세</th>
      <td>9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>공공분양</th>
      <td>7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>공공임대(5년)</th>
      <td>3</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.loc[train.공급유형.isin(['공공임대(5년)', '공공분양', '공공임대(10년)', '공공임대(분납)']), '공급유형'] = '공공임대(5년/10년/분납/분양)'
test.loc[test.공급유형.isin(['공공임대(5년)', '공공분양', '공공임대(10년)', '공공임대(분납)']), '공급유형'] = '공공임대(5년/10년/분납/분양)'
train.loc[train.공급유형.isin(['장기전세', '국민임대']), '공급유형'] = '국민임대/장기전세'
test.loc[test.공급유형.isin(['장기전세', '국민임대']), '공급유형'] = '국민임대/장기전세'
```


```python
set(train.공급유형)
```




    {'공공임대(50년)', '공공임대(5년/10년/분납/분양)', '국민임대/장기전세', '영구임대', '임대상가', '행복주택'}




```python
set(test.공급유형)
```




    {'공공임대(50년)', '공공임대(5년/10년/분납/분양)', '국민임대/장기전세', '영구임대', '임대상가', '행복주택'}




```python
reshape_cat_features(data=train, cast_col='공급유형', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>공급유형_공공임대(50년)</th>
      <th>공급유형_공공임대(5년/10년/분납/분양)</th>
      <th>공급유형_국민임대/장기전세</th>
      <th>공급유형_영구임대</th>
      <th>공급유형_임대상가</th>
      <th>공급유형_행복주택</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2663</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2666</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2670</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2680</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2692</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 6 columns</p>
</div>




```python
reshape_cat_features(data=test, cast_col='공급유형', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>공급유형_공공임대(50년)</th>
      <th>공급유형_공공임대(5년/10년/분납/분양)</th>
      <th>공급유형_국민임대/장기전세</th>
      <th>공급유형_영구임대</th>
      <th>공급유형_임대상가</th>
      <th>공급유형_행복주택</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1003</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1006</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1016</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1019</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1030</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2653</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2675</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2676</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2688</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2691</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 6 columns</p>
</div>



#### 자격유형

+ 변수생성 컨셉: 특정자격 유형이 많으면 그 단지는 등록차량수가 적을 것이다.
    + 예를들어, 소득수준이 낮은 자격유형의 세대가 많으면 주차수요가 적을 가능성이 높을 것으로 예상해볼 수 있다.
+ 문제는 특성이 비슷한 항목끼리 묶어야 의미가 있을 것 같은데, 비식별화 되어 있어서 각 코드값이 무엇인지 정확히 알 수 없다는 것임
+ 단지코드별로 자격유형별 세대수를 알 수 있으면 좋을 것 같지만 이 데이터에서는 파악 불가능
+ 자격유형별 소득수준을 간접적으로 파악하기 위해 자격유형별 임대보증금의 평균, 임대료의 평균을 변수로 사용해 볼 수 있을 것 같음


```python
pd.concat([train.자격유형.value_counts(), 
           test.자격유형.value_counts()], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>자격유형</th>
      <th>자격유형</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1775</td>
      <td>569.0</td>
    </tr>
    <tr>
      <th>D</th>
      <td>292</td>
      <td>114.0</td>
    </tr>
    <tr>
      <th>H</th>
      <td>154</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>J</th>
      <td>105</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>92</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>I</th>
      <td>49</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>E</th>
      <td>37</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>K</th>
      <td>33</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>L</th>
      <td>33</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>N</th>
      <td>29</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>B</th>
      <td>18</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>G</th>
      <td>9</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>M</th>
      <td>2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>O</th>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



B, F, O가 train 데이터에는 있지만, 
test 데이터에는 없음

[공공임대주택 공급대상]

- 영구임대 : 생계급여 또는 의료급여 수급자 등 (소득 1분위)
- 국민임대 : 무주택세대구성원 (소득 2~4분위)
- 장기전세 : 무주택세대구성원 (소득 3~4분위)
- 공공임대(5년/10년/분납) : 무주택세대구성원 (3~5분위)
- 행복주택 : 무주택세대구성원/무주택자 (소득 2~5분위)

이렇게 나눈 항목과 자격유형의 항목 수가 맞지 않음.


```python
train.loc[train.자격유형=='B', ['임대건물구분', '공급유형']].drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>임대건물구분</th>
      <th>공급유형</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>아파트</td>
      <td>국민임대/장기전세</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.loc[train.공급유형.isin(['국민임대/장기전세']), '자격유형'].value_counts()
```




    A    1524
    H     154
    E      34
    B      18
    G       9
    Name: 자격유형, dtype: int64



[국민임대/장기전세]

- (일반) 해당지역 거주 무주택세대구성원
- (특별/우선) 3자녀 이상 가구
- (특별/우선) 국가유공자
- (특별/우선) 영구임대 입주자
- (특별/우선) 비닐간이공작물 거주자
- (특별/우선) 신혼부부(혼인기간 5년이내)
- (특별/우선) 사업지구 철거민
- (특별/우선) 기타 공급대상(고령자, 노부모부양자, 장애인, 파독근로자 등)

#### 다른 공급유형별 자격유형 살펴보기


```python
train.loc[train.공급유형.isin(['영구임대']), '자격유형'].value_counts()
```




    C    92
    I    49
    E     3
    F     3
    A     2
    Name: 자격유형, dtype: int64



[영구임대]

- (일반) 생계급여 또는 의료급여 수급자
- (일반) 국가유공자
- (특별/우선) 수급자 선정기준의 소득인정액 이하인 국가유공자
- (특별/우선) 귀환국군포로
- (특별/우선) 수급자 신혼부부


```python
train.loc[train.공급유형.isin(['공공임대(5년/10년/분납/분양)']), '자격유형'].value_counts()
```




    A    218
    D      7
    Name: 자격유형, dtype: int64



[공공임대(5년/10년/분납/분양)]

- (일반) 해당지역 거주무주택세대구성원
- (특별/우선) 다자녀 특별
- (특별/우선) 신혼부부 특별
- (특별/우선) 생애최초 특별
- (특별/우선) 노부모부양 특별
- (특별/우선) 국가유공자 특별
- (특별/우선) 기타 특별(장애인, 철거민 등)


```python
train.loc[train.공급유형.isin(['행복주택']), '자격유형'].value_counts()
```




    J    105
    K     33
    L     33
    N     29
    M      2
    O      1
    Name: 자격유형, dtype: int64



[행복주택]

- 대학생(취준생 포함), 사회초년생(제취준생 포함), 신혼부부(예비신혼부부, 대학생, 취준생 신혼부부 포함), 고령자, 주거급여수급자, 산업단지 근로자


```python
train.loc[train.자격유형.isin(['J', 'L', 'K', 'N', 'M', 'O']), '공급유형'].value_counts()
```




    행복주택    203
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['J', 'L', 'K', 'N', 'M', 'O']), '자격유형'] = '행복주택_공급대상'
test.loc[test.자격유형.isin(['J', 'L', 'K', 'N', 'M', 'O']), '자격유형'] = '행복주택_공급대상'
```


```python
train.loc[train.자격유형.isin(['A']), '공급유형'].value_counts()
```




    국민임대/장기전세             1524
    공공임대(5년/10년/분납/분양)     218
    공공임대(50년)               31
    영구임대                     2
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['D']), '공급유형'].value_counts()
```




    임대상가                  285
    공공임대(5년/10년/분납/분양)      7
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['H']), '공급유형'].value_counts()
```




    국민임대/장기전세    154
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['C']), '공급유형'].value_counts()
```




    영구임대    92
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['I']), '공급유형'].value_counts()
```




    영구임대    49
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['E']), '공급유형'].value_counts()
```




    국민임대/장기전세    34
    영구임대          3
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['B']), '공급유형'].value_counts()
```




    국민임대/장기전세    18
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['G']), '공급유형'].value_counts()
```




    국민임대/장기전세    9
    Name: 공급유형, dtype: int64




```python
train.loc[train.자격유형.isin(['F']), '공급유형'].value_counts()
```




    영구임대    3
    Name: 공급유형, dtype: int64



'H', 'B', 'E', 'G' 는 국민임대/장기전세 공급대상

'C', 'I', 'F', 'G' 는 영구임대 공급대상


```python
train.loc[train.자격유형.isin(['H', 'B', 'E', 'G']), '자격유형'] = '국민임대/장기전세_공급대상'
test.loc[test.자격유형.isin(['H', 'B', 'E', 'G']), '자격유형'] = '국민임대/장기전세_공급대상'

train.loc[train.자격유형.isin(['C', 'I', 'F']), '자격유형'] = '영구임대_공급대상'
test.loc[test.자격유형.isin(['C', 'I', 'F']), '자격유형'] = '영구임대_공급대상'
```


```python
pd.concat([train.자격유형.value_counts(), 
           test.자격유형.value_counts()], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>자격유형</th>
      <th>자격유형</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1775</td>
      <td>569</td>
    </tr>
    <tr>
      <th>D</th>
      <td>292</td>
      <td>114</td>
    </tr>
    <tr>
      <th>국민임대/장기전세_공급대상</th>
      <td>218</td>
      <td>103</td>
    </tr>
    <tr>
      <th>행복주택_공급대상</th>
      <td>203</td>
      <td>121</td>
    </tr>
    <tr>
      <th>영구임대_공급대상</th>
      <td>144</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div>




```python
reshape_cat_features(data=train, cast_col='자격유형', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>자격유형_A</th>
      <th>자격유형_D</th>
      <th>자격유형_국민임대/장기전세_공급대상</th>
      <th>자격유형_영구임대_공급대상</th>
      <th>자격유형_행복주택_공급대상</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2663</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2666</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2670</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2680</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2692</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 5 columns</p>
</div>




```python
reshape_cat_features(data=test, cast_col='자격유형', value_col='counter')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>자격유형_A</th>
      <th>자격유형_D</th>
      <th>자격유형_국민임대/장기전세_공급대상</th>
      <th>자격유형_영구임대_공급대상</th>
      <th>자격유형_행복주택_공급대상</th>
    </tr>
    <tr>
      <th>단지코드</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1003</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1006</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1016</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1019</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1030</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C2653</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2675</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2676</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2688</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2691</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div>




```python
train_agg = pd.concat([train_agg,
                       reshape_cat_features(data=train, cast_col='임대건물구분', value_col='counter'),
                       reshape_cat_features(data=train, cast_col='공급유형', value_col='counter'),
                       reshape_cat_features(data=train, cast_col='자격유형', value_col='counter')], axis=1)

test_agg = pd.concat([test_agg,
                       reshape_cat_features(data=test, cast_col='임대건물구분', value_col='counter'),
                       reshape_cat_features(data=test, cast_col='공급유형', value_col='counter'),
                       reshape_cat_features(data=test, cast_col='자격유형', value_col='counter')], axis=1)
```


```python
train_agg.shape, test_agg.shape
```




    ((423, 20), (150, 19))



# 모델링 해보기


```python
cat_features = ['지역']
target_col = '등록차량수'
```


```python
from catboost import CatBoostRegressor
catb = CatBoostRegressor(
         cat_features=cat_features,
         loss_function='MAE',
         n_estimators=500, 
         learning_rate=0.05, 
         random_state=42
    )
    
catb.fit(train_agg.drop(columns=[target_col]), train_agg[target_col], verbose=100)
```

    0:	learn: 279.3964528	total: 18.8ms	remaining: 9.36s
    100:	learn: 100.3025011	total: 1.57s	remaining: 6.21s
    200:	learn: 75.2070254	total: 3.2s	remaining: 4.76s
    300:	learn: 62.5859656	total: 4.87s	remaining: 3.22s
    400:	learn: 54.0292543	total: 6.7s	remaining: 1.65s
    499:	learn: 50.0553217	total: 8.55s	remaining: 0us
    




    <catboost.core.CatBoostRegressor at 0x2170712a760>




```python
sample_submission = pd.read_csv('sample_submission.csv')
sample_submission.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1072</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1128</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1456</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C1840</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C1332</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
sample_submission['num'] = catb.predict(test_agg)
```


```python
sample_submission
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1072</td>
      <td>678.748011</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1128</td>
      <td>1183.305560</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1456</td>
      <td>568.547066</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C1840</td>
      <td>519.937576</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C1332</td>
      <td>1050.366626</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>C2456</td>
      <td>262.919072</td>
    </tr>
    <tr>
      <th>146</th>
      <td>C1266</td>
      <td>428.923075</td>
    </tr>
    <tr>
      <th>147</th>
      <td>C2152</td>
      <td>50.028510</td>
    </tr>
    <tr>
      <th>148</th>
      <td>C1267</td>
      <td>285.955245</td>
    </tr>
    <tr>
      <th>149</th>
      <td>C2189</td>
      <td>189.475808</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 2 columns</p>
</div>




```python
sample_submission.to_csv('submission_baseline_f.csv', index=False)
```


```python

```
